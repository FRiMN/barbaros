app-id: com.github.frimn.barbaros
runtime: org.kde.Platform
runtime-version: "6.7" # Версия KDE Runtime, совместимая с PySide6
sdk: org.kde.Sdk
command: barbaros # Команда для запуска, должна совпадать с Exec в .desktop и точкой входа
finish-args:
  # Разрешения для GUI-приложения
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri # Для аппаратного ускорения
  - --share=network
  # Если приложению нужен доступ к файлам пользователя:
  # - --filesystem=home

modules:
  - name: barbaros
    build-options:
      build-args:
        - --share=network
    buildsystem: simple
    build-commands:
      # Установка приложения с помощью pip (или uv)
      # Рекомендуется использовать pip из SDK для согласованности
      - pip3 install --verbose --exists-action=i --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} "barbaros"
      # Копирование файлов
      - install -Dm644 com.github.frimn.barbaros.desktop /app/share/applications/com.github.frimn.barbaros.desktop
      - install -Dm644 icon3.png /app/share/icons/hicolor/256x256/apps/com.github.frimn.barbaros.png
    sources:
      # Укажите источник кода вашего приложения
      # Это может быть архив (tar.gz), git-репозиторий или локальный файл
      - type: file
        path: ../dist/barbaros-*.whl # Путь к вашему wheel
      # Также нужно включить файлы данных (.desktop, иконки)
      - type: file
        path: com.github.frimn.barbaros.desktop
      - type: file
        path: icon3.png
